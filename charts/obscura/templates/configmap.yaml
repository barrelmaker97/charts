apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "obscura.fullname" . }}-config
  labels:
    {{- include "obscura.labels" . | nindent 4 }}
data:
  RUST_LOG: {{ .Values.obscura.logLevel | quote }}
  OBSCURA_TELEMETRY_OTLP_ENDPOINT: {{ .Values.obscura.telemetry.otlpEndpoint | quote }}
  OBSCURA_TELEMETRY_LOG_FORMAT: {{ .Values.obscura.telemetry.logFormat | quote }}
  OBSCURA_TELEMETRY_TRACE_SAMPLING_RATIO: {{ .Values.obscura.telemetry.traceSamplingRatio | quote }}
  OBSCURA_TELEMETRY_METRICS_EXPORT_INTERVAL_SECS: {{ .Values.obscura.telemetry.metricsExportIntervalSecs | quote }}
  OBSCURA_TELEMETRY_EXPORT_TIMEOUT_SECS: {{ .Values.obscura.telemetry.exportTimeoutSecs | quote }}
  OBSCURA_TTL_DAYS: {{ .Values.obscura.ttlDays | quote }}
  OBSCURA_AUTH_TOKEN_TTL_SECS: {{ .Values.obscura.auth.accessTokenTtlSecs | quote }}
  OBSCURA_AUTH_REFRESH_TOKEN_TTL_DAYS: {{ .Values.obscura.auth.refreshTokenTtlDays | quote }}
  OBSCURA_RATE_LIMIT_PER_SECOND: {{ .Values.obscura.rateLimit.perSecond | quote }}
  OBSCURA_RATE_LIMIT_BURST: {{ .Values.obscura.rateLimit.burst | quote }}
  OBSCURA_RATE_LIMIT_AUTH_PER_SECOND: {{ .Values.obscura.rateLimit.authPerSecond | quote }}
  OBSCURA_RATE_LIMIT_AUTH_BURST: {{ .Values.obscura.rateLimit.authBurst | quote }}
  OBSCURA_SERVER_HOST: {{ .Values.obscura.server.host | quote }}
  OBSCURA_SERVER_PORT: {{ .Values.obscura.server.port | quote }}
  OBSCURA_SERVER_MGMT_PORT: {{ .Values.obscura.server.mgmtPort | quote }}
  OBSCURA_SERVER_SHUTDOWN_TIMEOUT_SECS: {{ .Values.obscura.server.shutdownTimeoutSecs | quote }}
  OBSCURA_SERVER_REQUEST_TIMEOUT_SECS: {{ .Values.obscura.server.requestTimeoutSecs | quote }}
  OBSCURA_SERVER_GLOBAL_TIMEOUT_SECS: {{ .Values.obscura.server.globalTimeoutSecs | quote }}
  OBSCURA_HEALTH_DB_TIMEOUT_MS: {{ .Values.obscura.health.dbTimeoutMs | quote }}
  OBSCURA_HEALTH_STORAGE_TIMEOUT_MS: {{ .Values.obscura.health.storageTimeoutMs | quote }}
  OBSCURA_HEALTH_PUBSUB_TIMEOUT_MS: {{ .Values.obscura.health.pubsubTimeoutMs | quote }}
  OBSCURA_MESSAGING_INBOX_MAX_SIZE: {{ .Values.obscura.messaging.maxInboxSize | quote }}
  OBSCURA_MESSAGING_CLEANUP_INTERVAL_SECS: {{ .Values.obscura.messaging.cleanupIntervalSecs | quote }}
  OBSCURA_DATABASE_MAX_CONNECTIONS: {{ .Values.obscura.database.maxConnections | quote }}
  OBSCURA_DATABASE_MIN_CONNECTIONS: {{ .Values.obscura.database.minConnections | quote }}
  OBSCURA_DATABASE_ACQUIRE_TIMEOUT_SECS: {{ .Values.obscura.database.acquireTimeoutSecs | quote }}
  OBSCURA_DATABASE_IDLE_TIMEOUT_SECS: {{ .Values.obscura.database.idleTimeoutSecs | quote }}
  OBSCURA_DATABASE_MAX_LIFETIME_SECS: {{ .Values.obscura.database.maxLifetimeSecs | quote }}
  OBSCURA_NOTIFICATIONS_CLEANUP_INTERVAL_SECS: {{ .Values.obscura.notifications.cleanupIntervalSecs | quote }}
  OBSCURA_NOTIFICATIONS_GLOBAL_CHANNEL_CAPACITY: {{ .Values.obscura.notifications.globalChannelCapacity | quote }}
  OBSCURA_NOTIFICATIONS_USER_CHANNEL_CAPACITY: {{ .Values.obscura.notifications.userChannelCapacity | quote }}
  OBSCURA_NOTIFICATIONS_PUSH_DELAY_SECS: {{ .Values.obscura.notifications.pushDelaySecs | quote }}
  OBSCURA_NOTIFICATIONS_WORKER_INTERVAL_SECS: {{ .Values.obscura.notifications.workerIntervalSecs | quote }}
  OBSCURA_NOTIFICATIONS_WORKER_CONCURRENCY: {{ .Values.obscura.notifications.workerConcurrency | quote }}
  OBSCURA_NOTIFICATIONS_PUSH_QUEUE_KEY: {{ .Values.obscura.notifications.pushQueueKey | quote }}
  OBSCURA_NOTIFICATIONS_CHANNEL_PREFIX: {{ .Values.obscura.notifications.channelPrefix | quote }}
  OBSCURA_NOTIFICATIONS_VISIBILITY_TIMEOUT_SECS: {{ .Values.obscura.notifications.visibilityTimeoutSecs | quote }}
  OBSCURA_NOTIFICATIONS_INVALID_TOKEN_CLEANUP_INTERVAL_SECS: {{ .Values.obscura.notifications.invalidTokenCleanupIntervalSecs | quote }}
  OBSCURA_NOTIFICATIONS_INVALID_TOKEN_CLEANUP_BATCH_SIZE: {{ .Values.obscura.notifications.invalidTokenCleanupBatchSize | quote }}
  OBSCURA_NOTIFICATIONS_INVALID_TOKEN_CLEANUP_CHANNEL_CAPACITY: {{ .Values.obscura.notifications.invalidTokenCleanupChannelCapacity | quote }}
  OBSCURA_PUBSUB_MIN_BACKOFF_SECS: {{ .Values.obscura.pubsub.minBackoffSecs | quote }}
  OBSCURA_PUBSUB_MAX_BACKOFF_SECS: {{ .Values.obscura.pubsub.maxBackoffSecs | quote }}
  OBSCURA_MESSAGING_BATCH_LIMIT: {{ .Values.obscura.messaging.batchLimit | quote }}
  OBSCURA_PRE_KEY_REFILL_THRESHOLD: {{ .Values.obscura.messaging.preKeyRefillThreshold | quote }}
  OBSCURA_PRE_KEYS_MAX: {{ .Values.obscura.messaging.maxPreKeys | quote }}
  OBSCURA_SERVER_TRUSTED_PROXIES: {{ .Values.obscura.server.trustedProxies | quote }}
  OBSCURA_WS_OUTBOUND_BUFFER_SIZE: {{ .Values.obscura.websocket.outboundBufferSize | quote }}
  OBSCURA_WS_ACK_BUFFER_SIZE: {{ .Values.obscura.websocket.ackBufferSize | quote }}
  OBSCURA_WS_ACK_BATCH_SIZE: {{ .Values.obscura.websocket.ackBatchSize | quote }}
  OBSCURA_WS_ACK_FLUSH_INTERVAL_MS: {{ .Values.obscura.websocket.ackFlushIntervalMs | quote }}
  OBSCURA_WS_PING_INTERVAL_SECS: {{ .Values.obscura.websocket.pingIntervalSecs | quote }}
  OBSCURA_WS_PING_TIMEOUT_SECS: {{ .Values.obscura.websocket.pingTimeoutSecs | quote }}
  OBSCURA_ATTACHMENT_MAX_SIZE_BYTES: {{ printf "%d" (int .Values.obscura.attachment.maxSizeBytes) | quote }}
  OBSCURA_ATTACHMENT_MIN_SIZE_BYTES: {{ printf "%d" (int .Values.obscura.attachment.minSizeBytes) | quote }}
  OBSCURA_ATTACHMENT_PREFIX: {{ .Values.obscura.attachment.prefix | quote }}
  OBSCURA_ATTACHMENT_CLEANUP_INTERVAL_SECS: {{ .Values.obscura.attachment.cleanupIntervalSecs | quote }}
  OBSCURA_ATTACHMENT_CLEANUP_BATCH_SIZE: {{ .Values.obscura.attachment.cleanupBatchSize | quote }}
  OBSCURA_ATTACHMENT_TIMEOUT_SECS: {{ .Values.obscura.attachment.requestTimeoutSecs | quote }}
  OBSCURA_BACKUP_PREFIX: {{ .Values.obscura.backup.prefix | quote }}
  OBSCURA_BACKUP_MAX_SIZE_BYTES: {{ printf "%d" (int .Values.obscura.backup.maxSizeBytes) | quote }}
  OBSCURA_BACKUP_MIN_SIZE_BYTES: {{ printf "%d" (int .Values.obscura.backup.minSizeBytes) | quote }}
  OBSCURA_BACKUP_TIMEOUT_SECS: {{ .Values.obscura.backup.requestTimeoutSecs | quote }}
  OBSCURA_BACKUP_STALE_THRESHOLD_MINS: {{ .Values.obscura.backup.staleThresholdMins | quote }}
  OBSCURA_BACKUP_CLEANUP_INTERVAL_SECS: {{ .Values.obscura.backup.cleanupIntervalSecs | quote }}
  OBSCURA_STORAGE_BUCKET: {{ .Values.obscura.storage.bucket | quote }}
  OBSCURA_STORAGE_REGION: {{ .Values.obscura.storage.region | quote }}
  OBSCURA_STORAGE_ENDPOINT: {{ include "obscura.storageEndpoint" . | quote }}
  OBSCURA_STORAGE_FORCE_PATH_STYLE: {{ .Values.obscura.storage.forcePathStyle | quote }}
